// Scripts for WP JV Post Reading Groups
// @version: 2.4
jQuery(document).ready(function($){function wp_jv_prg_refresh_rg_list(){data={action:'wp_jv_prg_refresh_rg_list',url:ajaxurl,type:'POST'};$.post(ajaxurl,data,function(response){var response=$.parseJSON(response);if(response.rows.length){$('#the-list').html(response.rows)}})};$('#btnAddNewRG').on('click',function(event){event.preventDefault();$('#btnAddNewRG').attr('disabled',!0);$('#spnAddRG').show();var newrg=document.getElementById("jv-new-reading-group-text").value;data={action:'wp_jv_prg_add_new_rg_to_db',url:ajaxurl,type:'POST',dataType:'text','newrg':newrg,wp_jv_rg_nonce:wp_jv_prg_obj.wp_jv_rg_nonce};$.post(ajaxurl,data,function(response){if(response.error){alert(response.error_msg+'\n\n[Error: '+response.error_code+']')}else{wp_jv_prg_refresh_rg_list()}
$('#spnAddRG').hide();$('#btnAddNewRG').attr('disabled',!1);document.getElementById("jv-new-reading-group-text").value=''})});$('#the-list').on('click','.lnkEdit',function(event){event.preventDefault();$.ajaxSetup({async:!1});wp_jv_prg_refresh_rg_list();$.ajaxSetup({async:!0});var editRG=$(this).attr('data-RG');$('.RenameDiv-'+editRG).html('<input type="text" id="renamed-reading-group-text" style="width:100%" value="'+$('div.ItemDiv-'+editRG).text()+'">'+'<br><button class="btnCancelRG button-secondary">Cancel</button>'+'<button style="float:right" class="btnSaveRG button-primary" data-rename-RG="'+editRG+'">Save</button>')});$('#the-list').on('click','.btnCancelRG',function(event){event.preventDefault();wp_jv_prg_refresh_rg_list()});$('#the-list').on('click','.btnSaveRG',function(event){event.preventDefault();$('.btnSave').attr('disabled',!0);var NewRGName=document.getElementById("renamed-reading-group-text").value;var RGToRename=$(this).attr('data-rename-RG');data={action:'wp_jv_prg_save_renamed_rg_to_db',url:ajaxurl,type:'POST',dataType:'text','RGToRename':RGToRename,'NewRGName':NewRGName};$.post(ajaxurl,data,function(response){if(response.error){alert(response.error_msg+'\n\n[Error: '+response.error_code+']')}else{wp_jv_prg_refresh_rg_list()}});$('.btnSave').attr('disabled',!1)});$('#the-list').on('click','.lnkDelete',function(event){event.preventDefault();var delurl=jQuery(this).attr('href');data={action:'wp_jv_prg_delete_rg',url:ajaxurl,type:'POST','delurl':delurl};$.post(ajaxurl,data,function(response){if(response.error){alert(response.error_msg+'\n\n[Error: '+response.error_code+']')}else{wp_jv_prg_refresh_rg_list()}})})})